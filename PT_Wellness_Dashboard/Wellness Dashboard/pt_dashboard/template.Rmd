# `r getwd()`

```{r}
#| echo:    FALSE
#| message: FALSE
#| warning: FALSE

library(kableExtra)
library(tidyverse)
library(ggplot2)
library(knitr)
library(grid)

rolling_mean <- function(x) {
  rollmean(x, k = 3, fill = NA, align = 'right')
}

scale_func <- function(x) {
  sprintf("%.1f", x)
}

opts_knit$set(root.dir = getwd())

data <- params$data
data <- data[data$Name == hw, ]

data %>%
  pivot_longer(
    cols = !c(Date, Name, Therapist),
    names_to = "Questions",
    values_to = "Responses",
    values_drop_na = TRUE
  ) %>%
  ggplot(mapping = aes(x = Date, y = Responses)) +
  geom_line() +
  geom_point() +
  facet_wrap(~Questions, nrow = 3, scales = 'free') +
  theme(panel.spacing = unit(2, 'lines')) +
  scale_y_continuous(labels = scale_func)
```